"use client";

import { useState } from "react";
import { Line } from "react-chartjs-2";
import {
  Chart as ChartJS,
  LineElement,
  CategoryScale,
  LinearScale,
  PointElement,
  Tooltip,
  Legend,
} from "chart.js";

ChartJS.register(LineElement, CategoryScale, LinearScale, PointElement, Tooltip, Legend);

export default function ReflectionSheet() {
  const [title, setTitle] = useState("");
  const [goodPoints, setGoodPoints] = useState("");
  const [improvePoints, setImprovePoints] = useState("");

  const [itemName, setItemName] = useState("");
  const [itemValue, setItemValue] = useState("");
  const [records, setRecords] = useState<{ label: string; value: number }[]>([]);

  const addRecord = () => {
    if (!itemName || !itemValue) return;
    setRecords([...records, { label: itemName, value: Number(itemValue) }]);
    setItemName("");
    setItemValue("");
  };

  const chartData = {
    labels: records.map((r) => r.label),
    datasets: [
      {
        label: "è¨˜éŒ²å€¤",
        data: records.map((r) => r.value),
        borderWidth: 3,
        tension: 0.3,
      },
    ],
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-pink-50 via-blue-50 to-violet-50 p-6">
      <div className="max-w-3xl mx-auto space-y-8">

        {/* ã‚¿ã‚¤ãƒˆãƒ«ã‚«ãƒ¼ãƒ‰ */}
        <div className="bg-white/80 shadow-lg rounded-2xl p-6 border border-pink-100">
          <h2 className="text-2xl font-bold text-pink-700 mb-3">ğŸ”– æŒ¯ã‚Šè¿”ã‚Šã‚¿ã‚¤ãƒˆãƒ«</h2>
          <input
            value={title}
            onChange={(e) => setTitle(e.target.value)}
            className="w-full p-3 rounded-xl border border-pink-200 bg-pink-50 focus:ring-2 focus:ring-pink-300"
            placeholder="ä¾‹ï¼šä»Šæ—¥ã®æŒ¯ã‚Šè¿”ã‚Š"
          />
        </div>

        {/* è‰¯ã‹ã£ãŸç‚¹ */}
        <div className="bg-white/80 shadow-lg rounded-2xl p-6 border border-blue-100">
          <h2 className="text-2xl font-bold text-blue-700 mb-3">ğŸŒŸ è‰¯ã‹ã£ãŸç‚¹</h2>
          <textarea
            value={goodPoints}
            onChange={(e) => setGoodPoints(e.target.value)}
            className="w-full p-3 rounded-xl border border-blue-200 bg-blue-50 h-28 focus:ring-2 focus:ring-blue-300"
            placeholder="è‰¯ã‹ã£ãŸã“ã¨ã‚’æ›¸ã„ã¦ãã ã•ã„"
          />
        </div>

        {/* æ”¹å–„ç‚¹ */}
        <div className="bg-white/80 shadow-lg rounded-2xl p-6 border border-violet-100">
          <h2 className="text-2xl font-bold text-violet-700 mb-3">ğŸ”§ æ”¹å–„ç‚¹</h2>
          <textarea
            value={improvePoints}
            onChange={(e) => setImprovePoints(e.target.value)}
            className="w-full p-3 rounded-xl border border-violet-200 bg-violet-50 h-28 focus:ring-2 focus:ring-violet-300"
            placeholder="æ”¹å–„ã—ãŸã„ç‚¹ã‚’æ›¸ã„ã¦ãã ã•ã„"
          />
        </div>

        {/* å…¥åŠ›é …ç›®ã‚«ãƒ¼ãƒ‰ */}
        <div className="bg-white/80 shadow-lg rounded-2xl p-6 border border-teal-100">
          <h2 className="text-2xl font-bold text-teal-700 mb-4">ğŸ“Š è¨˜éŒ²é …ç›®ã®å…¥åŠ›</h2>

          <div className="grid grid-cols-2 gap-4">
            <input
              value={itemName}
              onChange={(e) => setItemName(e.target.value)}
              className="p-3 rounded-xl border border-teal-200 bg-teal-50 focus:ring-2 focus:ring-teal-300"
              placeholder="é …ç›®åï¼ˆä¾‹ï¼šç†è§£åº¦ï¼‰"
            />
            <input
              value={itemValue}
              onChange={(e) => setItemValue(e.target.value)}
              type="number"
              className="p-3 rounded-xl border border-teal-200 bg-teal-50 focus:ring-2 focus:ring-teal-300"
              placeholder="æ•°å€¤ï¼ˆä¾‹ï¼š80ï¼‰"
            />
          </div>

          <button
            onClick={addRecord}
            className="mt-4 px-4 py-2 bg-teal-500 text-white rounded-xl shadow hover:bg-teal-600"
          >
            è¿½åŠ 
          </button>
        </div>

        {/* ã‚°ãƒ©ãƒ• */}
        <div className="bg-white/80 shadow-lg rounded-2xl p-6 border border-yellow-100">
          <h2 className="text-2xl font-bold text-yellow-700 mb-4">ğŸ“ˆ ã‚°ãƒ©ãƒ•è¡¨ç¤º</h2>
          {records.length === 0 ? (
            <p className="text-gray-500">è¨˜éŒ²ã‚’è¿½åŠ ã™ã‚‹ã¨ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
          ) : (
            <Line data={chartData} />
          )}
        </div>
      </div>
    </div>
  );
}
