<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>振り返りシート + 評価 + グラフ</title>
<style>
  body { font-family: "Segoe UI", sans-serif; background: linear-gradient(135deg,#ffecd2,#fcb69f,#a1c4fd,#c2e9fb); margin: 0; padding: 20px; background-size: 400% 400%; animation: bgmove 12s ease infinite; }
  h1, h2 { text-align: center; }

  .section { max-width: 900px; margin: 20px auto; background: linear-gradient(135deg,#ffffff,#fef6ff,#f0f9ff); padding: 20px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); border: 2px solid #fff; }
  label { font-weight: bold; margin-top: 10px; display: block; }
  input, textarea { width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc; }
  textarea { height: 70px; }
  button { padding: 12px 22px; background: linear-gradient(135deg,#ff9a9e,#fad0c4,#fbc2eb,#a18cd1); color: #fff; border: none; border-radius: 10px; cursor: pointer; margin-top: 15px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
  button:hover { opacity: 0.85; transform: translateY(-2px); transition: 0.2s; }

  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  th, td { border: 1px solid #ccc; padding: 8px; background: #fff; }
  th { background: #f0f0f0; }

  .eval-table input { width: 70px; }
@keyframes bgmove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h1>振り返り入力システム</h1>

<div class="section">
  <h2>振り返りシート</h2>
  <label>氏名</label>
  <input id="name">

  <label>日付</label>
  <input id="date" type="date">

  <label>今日できたこと</label>
  <textarea id="good"></textarea>

  <label>今日の課題</label>
  <textarea id="bad"></textarea>

  <label>明日の目標</label>
  <textarea id="goal"></textarea>

  <button onclick="saveData()">保存</button>
</div>

<div class="section">
  <h2>評価入力（1〜7）</h2>
  <table class="eval-table">
    <tr><th>項目</th><th>評価</th></tr>
    <tr><td>発言頻度と貢献性</td><td><input type="number" id="s1" min="1" max="7"></td></tr>
    <tr><td>積極性と影響力</td><td><input type="number" id="s2" min="1" max="7"></td></tr>
    <tr><td>コミュニケーション性</td><td><input type="number" id="s3" min="1" max="7"></td></tr>
    <tr><td>受容性と反応性</td><td><input type="number" id="s4" min="1" max="7"></td></tr>
    <tr><td>協調性と連携性</td><td><input type="number" id="s5" min="1" max="7"></td></tr>
    <tr><td>ファシリテーター適性</td><td><input type="number" id="s6" min="1" max="7"></td></tr>
  </table>
  <button onclick="drawChart()">レーダーグラフ生成</button>
</div>

<div class="section">
  <h2>レーダーグラフ</h2>
  <canvas id="radarChart"></canvas>
</div>

<div class="section">
  <h2>保存一覧</h2>
  <table id="listTable">
    <tr><th>氏名</th><th>日付</th><th>できたこと</th><th>課題</th><th>目標</th></tr>
  </table>
</div>

<script>
function saveData() {
  const data = {
    name: name.value,
    date: date.value,
    good: good.value,
    bad: bad.value,
    goal: goal.value
  };
  const list = JSON.parse(localStorage.getItem('reflection') || '[]');
  list.push(data);
  localStorage.setItem('reflection', JSON.stringify(list));
  loadList();
  alert('保存しました');
}
function loadList() {
  const list = JSON.parse(localStorage.getItem('reflection') || '[]');
  listTable.innerHTML = '<tr><th>氏名</th><th>日付</th><th>できたこと</th><th>課題</th><th>目標</th></tr>';
  list.forEach(row => {
    listTable.innerHTML += `<tr>
      <td>${row.name}</td>
      <td>${row.date}</td>
      <td>${row.good}</td>
      <td>${row.bad}</td>
      <td>${row.goal}</td>
    </tr>`;
  });
}

let chart;
function drawChart() {
  const scores = [s1.value, s2.value, s3.value, s4.value, s5.value, s6.value];
  if (chart) chart.destroy();
  chart = new Chart(radarChart, {
    type: 'radar',
    data: {
      labels: ['発言頻度', '積極性', 'コミュ力', '受容性', '協調性', 'ファシリ適性'],
      datasets: [{
        label: '評価',
        data: scores,
        fill: true,
        backgroundColor: 'rgba(54,162,235,0.2)',
        borderColor: 'rgb(54,162,235)'
      }]
    },
    options: { scales: { r: { min: 0, max: 7 } } }
  });
}

loadList();
</script>
</body>
</html>
